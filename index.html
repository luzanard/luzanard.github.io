<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Adeptus Mechanicus — Army Builder 10th Edition</title>
  <meta name="description" content="Warhammer 40,000 10th Edition Army Builder for Adeptus Mechanicus">
  <link rel="stylesheet" href="theme.css">
</head>
<body>

  <div id="app-loading">
    <span class="cog-spin">⚙</span>
    <p>Consulting the Omnissiah&hellip;</p>
  </div>

  <div id="app" class="app-wrapper">

    <!-- ─── HEADER ─────────────────────────────────── -->
    <header class="app-header">
      <div class="header-brand">
        <span class="header-cog" aria-hidden="true">⚙</span>
        <div class="header-title-group">
          <h1 class="header-title">Adeptus Mechanicus</h1>
          <span class="header-subtitle">Warhammer 40,000 // 10th Edition // Army Builder</span>
        </div>
      </div>
      <div class="header-right">
        <select id="points-limit-select" class="select-styled" aria-label="Points limit"></select>
        <div class="points-display" aria-live="polite">
          <span class="points-display__label">Total</span>
          <span class="points-display__value"><span id="points-total">0</span></span>
          <span class="points-display__sep">/</span>
          <span class="points-display__limit"><span id="points-limit">2000</span> pts</span>
        </div>
        <div id="points-bar" class="points-bar-wrapper" role="progressbar">
          <div id="points-fill"></div>
        </div>
      </div>
    </header>

    <!-- ─── SIDEBAR ────────────────────────────────── -->
    <aside class="app-sidebar" aria-label="Army configuration">

      <!-- Army Rule -->
      <section class="sidebar-section">
        <h2 class="sidebar-section-title">◈ Army Rule</h2>
        <div class="army-rule-block">
          <p class="army-rule-name">Doctrina Imperatives</p>
          <p class="army-rule-desc">At the start of each battle round, select one Doctrina Imperative. All Adeptus Mechanicus units benefit from the chosen doctrine.</p>
        </div>
      </section>

      <!-- Doctrines -->
      <section class="sidebar-section">
        <h2 class="sidebar-section-title">⚙ Doctrina Imperatives</h2>
        <div class="doctrine-buttons">
          <button id="doctrine-protector" class="doctrine-btn">Protector</button>
          <button id="doctrine-conqueror" class="doctrine-btn">Conqueror</button>
        </div>
        <div id="active-doctrine-display" aria-live="polite">No doctrine active</div>
      </section>

      <!-- Stratagems & Detachments button -->
      <section class="sidebar-section">
        <button id="open-strat-modal-btn" class="strat-modal-open-btn">
          <span class="strat-btn-icon">⊞</span>
          <span class="strat-btn-text">
            <span class="strat-btn-primary">Stratagems &amp; Detachments</span>
            <span class="strat-btn-sub">Full reference — click to open</span>
          </span>
        </button>
      </section>

      <!-- Active detachment display (read-only, set from modal) -->
      <section class="sidebar-section" id="active-det-section" style="display:none">
        <h2 class="sidebar-section-title">▣ Active Detachment</h2>
        <div id="active-det-display" class="active-det-display"></div>
      </section>

    </aside>

    <!-- ─── MAIN CONTENT ──────────────────────────── -->
    <main class="app-main" aria-label="Army roster">
      <button id="add-unit-btn" class="add-unit-btn" aria-label="Add unit to roster">
        <span class="add-unit-icon">+</span>
        <span class="add-unit-text">
          <span class="add-unit-primary">◉ Requisition Unit</span>
          <span class="add-unit-secondary">Open the Datasheet Registry</span>
        </span>
      </button>
      <div id="roster-empty" aria-live="polite">
        <span class="empty-cog" aria-hidden="true">⚙</span>
        <p>No units deployed. Praise the Omnissiah.</p>
      </div>
      <div id="roster-list" aria-label="Deployed units"></div>
    </main>

  </div>

  <!-- ═══════════════════════════════════════════════════
       UNIT PICKER MODAL
  ═══════════════════════════════════════════════════ -->
  <div id="unit-picker-modal" class="modal-backdrop" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div class="modal-panel">
      <div class="modal-header">
        <div>
          <h2 class="modal-title" id="modal-title">◈ Requisition Unit</h2>
          <p class="modal-subtitle">Datasheet Registry — Adeptus Mechanicus</p>
        </div>
        <button class="modal-close-btn" aria-label="Close">✕</button>
      </div>
      <div id="unit-picker-list" aria-label="Available units"></div>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════
       STRATAGEMS & DETACHMENTS FULL-SCREEN MODAL
  ═══════════════════════════════════════════════════ -->
  <div id="strat-modal" class="strat-modal-backdrop" role="dialog" aria-modal="true">
    <div class="strat-modal-panel">

      <div class="strat-modal-header">
        <div class="strat-modal-title-group">
          <span class="strat-modal-cog">⚙</span>
          <div>
            <h2 class="strat-modal-title">Stratagems &amp; Detachments</h2>
            <p class="strat-modal-subtitle">Adeptus Mechanicus // 10th Edition Reference</p>
          </div>
        </div>
        <button class="strat-modal-close" aria-label="Close">✕</button>
      </div>

      <div class="strat-tabs" role="tablist">
        <button class="strat-tab strat-tab--active" data-tab="detachments"    role="tab">▣ Detachments</button>
        <button class="strat-tab"                   data-tab="det-stratagems" role="tab">⊞ Detachment Stratagems</button>
        <button class="strat-tab"                   data-tab="core"           role="tab">◈ Core Stratagems</button>
        <button class="strat-tab"                   data-tab="faction"        role="tab">⚙ Faction Stratagems</button>
      </div>

      <div class="strat-modal-body">
        <div id="strat-tab-detachments"    class="strat-tab-panel strat-tab-panel--active"></div>
        <div id="strat-tab-det-stratagems" class="strat-tab-panel"></div>
        <div id="strat-tab-core"           class="strat-tab-panel"></div>
        <div id="strat-tab-faction"        class="strat-tab-panel"></div>
      </div>

    </div>
  </div>

  <!-- Toast -->
  <div id="toast-container" aria-live="polite" aria-atomic="true"></div>

  <!-- Scripts -->
  <script src="DataLoader.js"></script>
  <script src="StatCalculator.js"></script>
  <script src="StateManager.js"></script>
  <script src="Renderer.js"></script>
  <script src="EventHandlers.js"></script>
  <script src="App.js"></script>

</body>
</html>
